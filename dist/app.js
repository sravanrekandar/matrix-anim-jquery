(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
"use strict";

var _modelControls = require("./model-controls");

var generateMatrix = _modelControls.generateMatrix;
var printMatrix = _modelControls.printMatrix;

var _viewModelControls = require("./view-model-controls");

var generateViewModel = _viewModelControls.generateViewModel;
var nextViewModel = _viewModelControls.nextViewModel;

var _viewControls = require("./view-controls");

var createCellViews = _viewControls.createCellViews;
var updateCellPositions = _viewControls.updateCellPositions;

var _constants = require("./constants");

var CONTAINER_ID = _constants.CONTAINER_ID;
var CELL_PROPS = _constants.CELL_PROPS;
var GUTTER = _constants.GUTTER;

var animTimeInteral = undefined;

function startApp() {
  clearInterval(animTimeInteral);
  var ROWS = Number($("#row-count").val());
  var COLUMNS = Number($("#column-count").val());

  var container = $(CONTAINER_ID);
  container.empty();

  var cellSize = CELL_PROPS.cellSize;

  container.width(COLUMNS * cellSize + (COLUMNS + 1) * GUTTER);
  container.height(ROWS * cellSize + (ROWS + 1) * GUTTER);

  var matrix = generateMatrix(ROWS, COLUMNS);
  printMatrix(matrix);
  var viewModel = generateViewModel(matrix);

  createCellViews(container, viewModel);

  animTimeInteral = setInterval(function () {
    viewModel = nextViewModel(viewModel);
    updateCellPositions(viewModel);
  }, 1000);
}

$(function () {
  startApp();

  var start = function () {
    startApp();
  };
  $("#reset").click(start);

  $("#row-count, #column-count").change(start);
});

},{"./constants":2,"./model-controls":3,"./view-controls":4,"./view-model-controls":5}],2:[function(require,module,exports){
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
var CONTAINER_ID = "#matrix-container";

exports.CONTAINER_ID = CONTAINER_ID;
var CELL_PROPS = {
  cellTemplate: function (cell) {
    return "<div class=\"cell\">" + cell.text + "</cell>";
  },
  cellSize: 30 };

exports.CELL_PROPS = CELL_PROPS;
var GUTTER = 10;
exports.GUTTER = GUTTER;

},{}],3:[function(require,module,exports){
"use strict";

exports.generateMatrix = generateMatrix;
exports.printMatrix = printMatrix;
Object.defineProperty(exports, "__esModule", {
  value: true
});

function generateMatrix(ROWS, COLUMNS) {
  var matrix = [];
  var count = 0;
  for (var i = 0; i < ROWS; i++) {
    var row = [];
    for (var j = 0; j < COLUMNS; j++) {
      row.push(++count);
    }
    matrix.push(row);
  }

  return matrix;
}

function printMatrix(matrix) {
  var str = "";
  for (var i = 0; i < matrix.length; i++) {
    for (var j = 0; j < matrix[i].length; j++) {
      str += "\t" + matrix[i][j];
    }
    str += "\n";
  }

  return str;
}

},{}],4:[function(require,module,exports){
"use strict";

exports.createCellViews = createCellViews;
exports.updateCellPositions = updateCellPositions;
Object.defineProperty(exports, "__esModule", {
  value: true
});

var _constants = require("./constants");

var CELL_PROPS = _constants.CELL_PROPS;
var GUTTER = _constants.GUTTER;

function getCellViewPosition(cell) {
  var cellSize = CELL_PROPS.cellSize;

  var top = cell.position.x * (cellSize + GUTTER) + (cell.position.x + GUTTER);
  var left = cell.position.y * (cellSize + GUTTER) + (cell.position.y + GUTTER);
  return {
    top: "" + top + "px",
    left: "" + left + "px" };
}

function createCellViews(container, viewModel) {
  var cellTemplate = CELL_PROPS.cellTemplate;

  for (var i = 0; i < viewModel.length; i++) {
    var cell = viewModel[i];
    var newCellView = $(cellTemplate({ text: cell.text }));
    newCellView.css(getCellViewPosition(cell));
    newCellView.prop("id", cell.id);
    container.append(newCellView);
  }
}

function updateCellPositions(viewModel) {
  viewModel.forEach(function (cell) {
    $("#" + cell.id).animate(getCellViewPosition(cell), 700);
  });
}

},{"./constants":2}],5:[function(require,module,exports){
"use strict";

exports.generateViewModel = generateViewModel;
exports.nextViewModel = nextViewModel;
Object.defineProperty(exports, "__esModule", {
  value: true
});
function addElementToList(list, row, column, matrix) {
  var hasElement = list.find(function (el) {
    return el.id === "cell-" + row + "-" + column;
  });
  if (!hasElement) {
    list.push({
      id: "cell-" + row + "-" + column,
      text: matrix[row][column],
      position: {
        x: row,
        y: column } });
  }
}

function generateViewModel(matrix) {
  var ROWS = matrix.length;
  var COLUMNS = matrix[0].length;

  var numberOfCircles = Math.ceil(Math.min(ROWS, COLUMNS) / 2);

  var allCircleElements = [];
  var row = undefined;
  var column = undefined;

  for (var circle = 0; circle < numberOfCircles; circle++) {
    (function (circle) {
      var circleElements = [];

      // Top Edge
      /*
        ,____________________,
        |  00    01   02 |  03
        '--------------------'
        10    11   12    13
        20    21   22    23
        30    31   32    33
      */
      row = circle;
      for (column = circle; column < COLUMNS - circle - 1; column++) {
        addElementToList(circleElements, row, column, matrix);
      }

      // Right Edge
      /*
                  ,_____,
        00    01   02   |  03 |
        10    11   12   |  13 |
        20    21   22   |  23 |
                  `-----'
        30    31   32    33
      */
      column = COLUMNS - circle - 1;
      for (row = circle; row < ROWS - circle - 1; row++) {
        addElementToList(circleElements, row, column, matrix);
      }

      // Bottom Edge
      /*
        00    01   02    03
        10    11   12    13
        20    21   22    23
            ,____________________,
        30  |  31   32    33 |
            `--------------------'
      */
      row = ROWS - circle - 1;
      for (column = COLUMNS - circle - 1; column > circle; column--) {
        addElementToList(circleElements, row, column, matrix);
      }

      // Left Edge
      /*
        00    01   02    03
        ,____,
        | 10 |   11   12    13
        | 20 |   21   22    23
        | 30 |   31   32    33
        '----'
      */
      column = circle;
      for (row = ROWS - circle - 1; row > circle; row--) {
        addElementToList(circleElements, row, column, matrix);
      }

      // Center cell
      if (ROWS === COLUMNS && ROWS % 2 === 1 && circle === numberOfCircles - 1) {
        addElementToList(circleElements, row, column, matrix);
      }

      // Mapping next and prev nodes
      circleElements.forEach(function (el, idx) {
        var cell = el;
        if (cell.disbleAnimations) {
          cell.nextPosition = el.position;
          cell.prevPosition = el.position;
        }

        cell.nextPosition = circleElements[(idx + 1) % circleElements.length].position;
        cell.prevPosition = circleElements[Math.abs(circleElements.length + idx - 1) % circleElements.length].position;
      });

      allCircleElements = allCircleElements.concat(circleElements);
    })(circle);
  }

  return allCircleElements;
}

function nextViewModel(model) {
  var nextModel = model.map(function (item) {
    var nextElement = model.find(function (el) {
      return R.equals(el.position, item.nextPosition);
    });
    nextElement = R.clone(nextElement);
    nextElement.text = item.text;
    nextElement.id = item.id;
    return nextElement;
  });

  return nextModel;
}

},{}]},{},[1])
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCIvbWVkaWEvc2FyYXZhbi9BNEFDNjE2Q0FDNjEzQTQ2L3dvcmsgYXJlYS9HSVQvbWF0cml4LWFuaW0tanF1ZXJ5L3NyYy9hcHAuanMiLCIvbWVkaWEvc2FyYXZhbi9BNEFDNjE2Q0FDNjEzQTQ2L3dvcmsgYXJlYS9HSVQvbWF0cml4LWFuaW0tanF1ZXJ5L3NyYy9jb25zdGFudHMuanMiLCIvbWVkaWEvc2FyYXZhbi9BNEFDNjE2Q0FDNjEzQTQ2L3dvcmsgYXJlYS9HSVQvbWF0cml4LWFuaW0tanF1ZXJ5L3NyYy9tb2RlbC1jb250cm9scy5qcyIsIi9tZWRpYS9zYXJhdmFuL0E0QUM2MTZDQUM2MTNBNDYvd29yayBhcmVhL0dJVC9tYXRyaXgtYW5pbS1qcXVlcnkvc3JjL3ZpZXctY29udHJvbHMuanMiLCIvbWVkaWEvc2FyYXZhbi9BNEFDNjE2Q0FDNjEzQTQ2L3dvcmsgYXJlYS9HSVQvbWF0cml4LWFuaW0tanF1ZXJ5L3NyYy92aWV3LW1vZGVsLWNvbnRyb2xzLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBOzs7NkJDQTRDLGtCQUFrQjs7SUFBckQsY0FBYyxrQkFBZCxjQUFjO0lBQUUsV0FBVyxrQkFBWCxXQUFXOztpQ0FDYSx1QkFBdUI7O0lBQS9ELGlCQUFpQixzQkFBakIsaUJBQWlCO0lBQUUsYUFBYSxzQkFBYixhQUFhOzs0QkFDWSxpQkFBaUI7O0lBQTdELGVBQWUsaUJBQWYsZUFBZTtJQUFFLG1CQUFtQixpQkFBbkIsbUJBQW1COzt5QkFDSSxhQUFhOztJQUFyRCxZQUFZLGNBQVosWUFBWTtJQUFFLFVBQVUsY0FBVixVQUFVO0lBQUUsTUFBTSxjQUFOLE1BQU07O0FBRXpDLElBQUksZUFBZSxZQUFBLENBQUE7O0FBRW5CLFNBQVMsUUFBUSxHQUFHO0FBQ2xCLGVBQWEsQ0FBQyxlQUFlLENBQUMsQ0FBQTtBQUM5QixNQUFNLElBQUksR0FBRyxNQUFNLENBQUMsQ0FBQyxDQUFDLFlBQVksQ0FBQyxDQUFDLEdBQUcsRUFBRSxDQUFDLENBQUE7QUFDMUMsTUFBTSxPQUFPLEdBQUcsTUFBTSxDQUFDLENBQUMsQ0FBQyxlQUFlLENBQUMsQ0FBQyxHQUFHLEVBQUUsQ0FBQyxDQUFBOztBQUVoRCxNQUFNLFNBQVMsR0FBRyxDQUFDLENBQUMsWUFBWSxDQUFDLENBQUE7QUFDakMsV0FBUyxDQUFDLEtBQUssRUFBRSxDQUFBOztNQUVULFFBQVEsR0FBSyxVQUFVLENBQXZCLFFBQVE7O0FBQ2hCLFdBQVMsQ0FBQyxLQUFLLENBQUMsQUFBQyxPQUFPLEdBQUcsUUFBUSxHQUFLLENBQUMsT0FBTyxHQUFHLENBQUMsQ0FBQSxHQUFJLE1BQU0sQUFBQyxDQUFDLENBQUE7QUFDaEUsV0FBUyxDQUFDLE1BQU0sQ0FBQyxBQUFDLElBQUksR0FBRyxRQUFRLEdBQUssQ0FBQyxJQUFJLEdBQUcsQ0FBQyxDQUFBLEdBQUksTUFBTSxBQUFDLENBQUMsQ0FBQTs7QUFFM0QsTUFBTSxNQUFNLEdBQUcsY0FBYyxDQUFDLElBQUksRUFBRSxPQUFPLENBQUMsQ0FBQTtBQUM1QyxhQUFXLENBQUMsTUFBTSxDQUFDLENBQUE7QUFDbkIsTUFBSSxTQUFTLEdBQUcsaUJBQWlCLENBQUMsTUFBTSxDQUFDLENBQUE7O0FBRXpDLGlCQUFlLENBQUMsU0FBUyxFQUFFLFNBQVMsQ0FBQyxDQUFBOztBQUVyQyxpQkFBZSxHQUFHLFdBQVcsQ0FBQyxZQUFNO0FBQ2xDLGFBQVMsR0FBRyxhQUFhLENBQUMsU0FBUyxDQUFDLENBQUE7QUFDcEMsdUJBQW1CLENBQUMsU0FBUyxDQUFDLENBQUE7R0FDL0IsRUFBRSxJQUFJLENBQUMsQ0FBQTtDQUNUOztBQUVELENBQUMsQ0FBQyxZQUFNO0FBQ04sVUFBUSxFQUFFLENBQUE7O0FBRVYsTUFBTSxLQUFLLEdBQUcsWUFBTTtBQUNsQixZQUFRLEVBQUUsQ0FBQTtHQUNYLENBQUE7QUFDRCxHQUFDLENBQUMsUUFBUSxDQUFDLENBQUMsS0FBSyxDQUFDLEtBQUssQ0FBQyxDQUFBOztBQUV4QixHQUFDLENBQUMsMkJBQTJCLENBQUMsQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDLENBQUE7Q0FDN0MsQ0FBQyxDQUFBOzs7Ozs7OztBQ3hDSyxJQUFNLFlBQVksR0FBRyxtQkFBbUIsQ0FBQTs7UUFBbEMsWUFBWSxHQUFaLFlBQVk7QUFFbEIsSUFBTSxVQUFVLEdBQUc7QUFDeEIsY0FBWSxFQUFFLFVBQUMsSUFBSTtvQ0FBMkIsSUFBSSxDQUFDLElBQUk7R0FBVTtBQUNqRSxVQUFRLEVBQUUsRUFBRSxFQUNiLENBQUE7O1FBSFksVUFBVSxHQUFWLFVBQVU7QUFLaEIsSUFBTSxNQUFNLEdBQUcsRUFBRSxDQUFBO1FBQVgsTUFBTSxHQUFOLE1BQU07Ozs7O1FDUEgsY0FBYyxHQUFkLGNBQWM7UUFjZCxXQUFXLEdBQVgsV0FBVzs7Ozs7QUFkcEIsU0FBUyxjQUFjLENBQUMsSUFBSSxFQUFFLE9BQU8sRUFBRTtBQUM1QyxNQUFNLE1BQU0sR0FBRyxFQUFFLENBQUE7QUFDakIsTUFBSSxLQUFLLEdBQUcsQ0FBQyxDQUFBO0FBQ2IsT0FBSyxJQUFJLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxHQUFHLElBQUksRUFBRSxDQUFDLEVBQUUsRUFBRTtBQUM3QixRQUFNLEdBQUcsR0FBRyxFQUFFLENBQUE7QUFDZCxTQUFLLElBQUksQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsT0FBTyxFQUFFLENBQUMsRUFBRSxFQUFFO0FBQ2hDLFNBQUcsQ0FBQyxJQUFJLENBQUMsRUFBRSxLQUFLLENBQUMsQ0FBQTtLQUNsQjtBQUNELFVBQU0sQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUE7R0FDakI7O0FBRUQsU0FBTyxNQUFNLENBQUE7Q0FDZDs7QUFFTSxTQUFTLFdBQVcsQ0FBQyxNQUFNLEVBQUU7QUFDbEMsTUFBSSxHQUFHLEdBQUcsRUFBRSxDQUFBO0FBQ1osT0FBSyxJQUFJLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxHQUFHLE1BQU0sQ0FBQyxNQUFNLEVBQUUsQ0FBQyxFQUFFLEVBQUU7QUFDdEMsU0FBSyxJQUFJLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxHQUFHLE1BQU0sQ0FBQyxDQUFDLENBQUMsQ0FBQyxNQUFNLEVBQUUsQ0FBQyxFQUFFLEVBQUU7QUFDekMsU0FBRyxXQUFTLE1BQU0sQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQUFBRSxDQUFBO0tBQzNCO0FBQ0QsT0FBRyxJQUFJLElBQUksQ0FBQTtHQUNaOztBQUVELFNBQU8sR0FBRyxDQUFBO0NBQ1g7Ozs7O1FDWmUsZUFBZSxHQUFmLGVBQWU7UUFZZixtQkFBbUIsR0FBbkIsbUJBQW1COzs7Ozt5QkF4QkEsYUFBYTs7SUFBdkMsVUFBVSxjQUFWLFVBQVU7SUFBRSxNQUFNLGNBQU4sTUFBTTs7QUFFM0IsU0FBUyxtQkFBbUIsQ0FBQyxJQUFJLEVBQUU7TUFDekIsUUFBUSxHQUFLLFVBQVUsQ0FBdkIsUUFBUTs7QUFDaEIsTUFBTSxHQUFHLEdBQUcsQUFBQyxJQUFJLENBQUMsUUFBUSxDQUFDLENBQUMsSUFBSSxRQUFRLEdBQUcsTUFBTSxDQUFBLEFBQUMsSUFBSyxJQUFJLENBQUMsUUFBUSxDQUFDLENBQUMsR0FBRyxNQUFNLENBQUEsQUFBQyxDQUFBO0FBQ2hGLE1BQU0sSUFBSSxHQUFHLEFBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxDQUFDLElBQUksUUFBUSxHQUFHLE1BQU0sQ0FBQSxBQUFDLElBQUssSUFBSSxDQUFDLFFBQVEsQ0FBQyxDQUFDLEdBQUcsTUFBTSxDQUFBLEFBQUMsQ0FBQTtBQUNqRixTQUFPO0FBQ0wsT0FBRyxPQUFLLEdBQUcsT0FBSTtBQUNmLFFBQUksT0FBSyxJQUFJLE9BQUksRUFDbEIsQ0FBQTtDQUNGOztBQUVNLFNBQVMsZUFBZSxDQUFDLFNBQVMsRUFBRSxTQUFTLEVBQUU7TUFDNUMsWUFBWSxHQUFLLFVBQVUsQ0FBM0IsWUFBWTs7QUFFcEIsT0FBSyxJQUFJLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxHQUFHLFNBQVMsQ0FBQyxNQUFNLEVBQUUsQ0FBQyxFQUFFLEVBQUU7QUFDekMsUUFBTSxJQUFJLEdBQUcsU0FBUyxDQUFDLENBQUMsQ0FBQyxDQUFBO0FBQ3pCLFFBQU0sV0FBVyxHQUFHLENBQUMsQ0FBQyxZQUFZLENBQUMsRUFBRSxJQUFJLEVBQUUsSUFBSSxDQUFDLElBQUksRUFBRSxDQUFDLENBQUMsQ0FBQTtBQUN4RCxlQUFXLENBQUMsR0FBRyxDQUFDLG1CQUFtQixDQUFDLElBQUksQ0FBQyxDQUFDLENBQUE7QUFDMUMsZUFBVyxDQUFDLElBQUksQ0FBQyxJQUFJLEVBQUUsSUFBSSxDQUFDLEVBQUUsQ0FBQyxDQUFBO0FBQy9CLGFBQVMsQ0FBQyxNQUFNLENBQUMsV0FBVyxDQUFDLENBQUE7R0FDOUI7Q0FDRjs7QUFFTSxTQUFTLG1CQUFtQixDQUFDLFNBQVMsRUFBRTtBQUM3QyxXQUFTLENBQUMsT0FBTyxDQUFDLFVBQUMsSUFBSSxFQUFLO0FBQzFCLEtBQUMsT0FBSyxJQUFJLENBQUMsRUFBRSxDQUFHLENBQUMsT0FBTyxDQUFDLG1CQUFtQixDQUFDLElBQUksQ0FBQyxFQUFFLEdBQUcsQ0FBQyxDQUFBO0dBQ3pELENBQUMsQ0FBQTtDQUNIOzs7OztRQ2RlLGlCQUFpQixHQUFqQixpQkFBaUI7UUE0RmpCLGFBQWEsR0FBYixhQUFhOzs7O0FBMUc3QixTQUFTLGdCQUFnQixDQUFDLElBQUksRUFBRSxHQUFHLEVBQUUsTUFBTSxFQUFFLE1BQU0sRUFBRTtBQUNuRCxNQUFNLFVBQVUsR0FBRyxJQUFJLENBQUMsSUFBSSxDQUFDLFVBQUMsRUFBRTtXQUFNLEVBQUUsQ0FBQyxFQUFFLGVBQWEsR0FBRyxTQUFJLE1BQU0sQUFBRTtHQUFDLENBQUMsQ0FBQTtBQUN6RSxNQUFJLENBQUMsVUFBVSxFQUFFO0FBQ2YsUUFBSSxDQUFDLElBQUksQ0FBQztBQUNSLFFBQUUsWUFBVSxHQUFHLFNBQUksTUFBTSxBQUFFO0FBQzNCLFVBQUksRUFBRSxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUMsTUFBTSxDQUFDO0FBQ3pCLGNBQVEsRUFBRTtBQUNSLFNBQUMsRUFBRSxHQUFHO0FBQ04sU0FBQyxFQUFFLE1BQU0sRUFDVixFQUNGLENBQUMsQ0FBQTtHQUNIO0NBQ0Y7O0FBRU0sU0FBUyxpQkFBaUIsQ0FBQyxNQUFNLEVBQUU7QUFDeEMsTUFBTSxJQUFJLEdBQUcsTUFBTSxDQUFDLE1BQU0sQ0FBQTtBQUMxQixNQUFNLE9BQU8sR0FBRyxNQUFNLENBQUMsQ0FBQyxDQUFDLENBQUMsTUFBTSxDQUFBOztBQUVoQyxNQUFNLGVBQWUsR0FBRyxJQUFJLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsSUFBSSxFQUFFLE9BQU8sQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFBOztBQUU5RCxNQUFJLGlCQUFpQixHQUFHLEVBQUUsQ0FBQTtBQUMxQixNQUFJLEdBQUcsWUFBQSxDQUFBO0FBQ1AsTUFBSSxNQUFNLFlBQUEsQ0FBQTs7QUFFVixPQUFLLElBQUksTUFBTSxHQUFHLENBQUMsRUFBRSxNQUFNLEdBQUcsZUFBZSxFQUFFLE1BQU0sRUFBRSxFQUFFO2VBQWhELE1BQU07QUFDYixVQUFNLGNBQWMsR0FBRyxFQUFFLENBQUE7Ozs7Ozs7Ozs7O0FBV3pCLFNBQUcsR0FBRyxNQUFNLENBQUE7QUFDWixXQUFLLE1BQU0sR0FBRyxNQUFNLEVBQUUsTUFBTSxHQUFHLE9BQU8sR0FBRyxNQUFNLEdBQUcsQ0FBQyxFQUFFLE1BQU0sRUFBRSxFQUFFO0FBQzdELHdCQUFnQixDQUFDLGNBQWMsRUFBRSxHQUFHLEVBQUUsTUFBTSxFQUFFLE1BQU0sQ0FBQyxDQUFBO09BQ3REOzs7Ozs7Ozs7OztBQVdELFlBQU0sR0FBRyxPQUFPLEdBQUcsTUFBTSxHQUFHLENBQUMsQ0FBQTtBQUM3QixXQUFLLEdBQUcsR0FBRyxNQUFNLEVBQUUsR0FBRyxHQUFHLElBQUksR0FBRyxNQUFNLEdBQUcsQ0FBQyxFQUFFLEdBQUcsRUFBRSxFQUFFO0FBQ2pELHdCQUFnQixDQUFDLGNBQWMsRUFBRSxHQUFHLEVBQUUsTUFBTSxFQUFFLE1BQU0sQ0FBQyxDQUFBO09BQ3REOzs7Ozs7Ozs7OztBQVdELFNBQUcsR0FBRyxJQUFJLEdBQUcsTUFBTSxHQUFHLENBQUMsQ0FBQTtBQUN2QixXQUFLLE1BQU0sR0FBRyxPQUFPLEdBQUcsTUFBTSxHQUFHLENBQUMsRUFBRSxNQUFNLEdBQUcsTUFBTSxFQUFFLE1BQU0sRUFBRSxFQUFFO0FBQzdELHdCQUFnQixDQUFDLGNBQWMsRUFBRSxHQUFHLEVBQUUsTUFBTSxFQUFFLE1BQU0sQ0FBQyxDQUFBO09BQ3REOzs7Ozs7Ozs7OztBQVdELFlBQU0sR0FBRyxNQUFNLENBQUE7QUFDZixXQUFLLEdBQUcsR0FBRyxJQUFJLEdBQUcsTUFBTSxHQUFHLENBQUMsRUFBRSxHQUFHLEdBQUcsTUFBTSxFQUFFLEdBQUcsRUFBRSxFQUFFO0FBQ2pELHdCQUFnQixDQUFDLGNBQWMsRUFBRSxHQUFHLEVBQUUsTUFBTSxFQUFFLE1BQU0sQ0FBQyxDQUFBO09BQ3REOzs7QUFHRCxVQUFJLElBQUksS0FBSyxPQUFPLElBQUksSUFBSSxHQUFHLENBQUMsS0FBSyxDQUFDLElBQUksTUFBTSxLQUFLLGVBQWUsR0FBRyxDQUFDLEVBQUU7QUFDeEUsd0JBQWdCLENBQUMsY0FBYyxFQUFFLEdBQUcsRUFBRSxNQUFNLEVBQUUsTUFBTSxDQUFDLENBQUE7T0FDdEQ7OztBQUdELG9CQUFjLENBQUMsT0FBTyxDQUFDLFVBQUMsRUFBRSxFQUFFLEdBQUcsRUFBSztBQUNsQyxZQUFNLElBQUksR0FBRyxFQUFFLENBQUE7QUFDZixZQUFJLElBQUksQ0FBQyxnQkFBZ0IsRUFBRTtBQUN6QixjQUFJLENBQUMsWUFBWSxHQUFHLEVBQUUsQ0FBQyxRQUFRLENBQUE7QUFDL0IsY0FBSSxDQUFDLFlBQVksR0FBRyxFQUFFLENBQUMsUUFBUSxDQUFBO1NBQ2hDOztBQUVELFlBQUksQ0FBQyxZQUFZLEdBQUcsY0FBYyxDQUFDLENBQUMsR0FBRyxHQUFHLENBQUMsQ0FBQSxHQUFJLGNBQWMsQ0FBQyxNQUFNLENBQUMsQ0FBQyxRQUFRLENBQUE7QUFDOUUsWUFBSSxDQUFDLFlBQVksR0FBRyxjQUFjLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxjQUFjLENBQUMsTUFBTSxHQUFHLEdBQUcsR0FBRyxDQUFDLENBQUMsR0FBRyxjQUFjLENBQUMsTUFBTSxDQUFDLENBQUMsUUFBUSxDQUFBO09BQy9HLENBQUMsQ0FBQTs7QUFFRix1QkFBaUIsR0FBRyxpQkFBaUIsQ0FBQyxNQUFNLENBQUMsY0FBYyxDQUFDLENBQUE7T0E1RXJELE1BQU07R0E2RWQ7O0FBRUQsU0FBTyxpQkFBaUIsQ0FBQTtDQUN6Qjs7QUFFTSxTQUFTLGFBQWEsQ0FBQyxLQUFLLEVBQUU7QUFDbkMsTUFBTSxTQUFTLEdBQUcsS0FBSyxDQUFDLEdBQUcsQ0FBQyxVQUFDLElBQUksRUFBSztBQUNwQyxRQUFJLFdBQVcsR0FBRyxLQUFLLENBQUMsSUFBSSxDQUFDLFVBQUMsRUFBRTthQUFNLENBQUMsQ0FBQyxNQUFNLENBQUMsRUFBRSxDQUFDLFFBQVEsRUFBRSxJQUFJLENBQUMsWUFBWSxDQUFDO0tBQUMsQ0FBQyxDQUFBO0FBQ2hGLGVBQVcsR0FBRyxDQUFDLENBQUMsS0FBSyxDQUFDLFdBQVcsQ0FBQyxDQUFBO0FBQ2xDLGVBQVcsQ0FBQyxJQUFJLEdBQUcsSUFBSSxDQUFDLElBQUksQ0FBQTtBQUM1QixlQUFXLENBQUMsRUFBRSxHQUFHLElBQUksQ0FBQyxFQUFFLENBQUE7QUFDeEIsV0FBTyxXQUFXLENBQUE7R0FDbkIsQ0FBQyxDQUFBOztBQUVGLFNBQU8sU0FBUyxDQUFBO0NBQ2pCIiwiZmlsZSI6ImdlbmVyYXRlZC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gZSh0LG4scil7ZnVuY3Rpb24gcyhvLHUpe2lmKCFuW29dKXtpZighdFtvXSl7dmFyIGE9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtpZighdSYmYSlyZXR1cm4gYShvLCEwKTtpZihpKXJldHVybiBpKG8sITApO3ZhciBmPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIrbytcIidcIik7dGhyb3cgZi5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGZ9dmFyIGw9bltvXT17ZXhwb3J0czp7fX07dFtvXVswXS5jYWxsKGwuZXhwb3J0cyxmdW5jdGlvbihlKXt2YXIgbj10W29dWzFdW2VdO3JldHVybiBzKG4/bjplKX0sbCxsLmV4cG9ydHMsZSx0LG4scil9cmV0dXJuIG5bb10uZXhwb3J0c312YXIgaT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2Zvcih2YXIgbz0wO288ci5sZW5ndGg7bysrKXMocltvXSk7cmV0dXJuIHN9KSIsImltcG9ydCB7IGdlbmVyYXRlTWF0cml4LCBwcmludE1hdHJpeCB9IGZyb20gJy4vbW9kZWwtY29udHJvbHMnXG5pbXBvcnQgeyBnZW5lcmF0ZVZpZXdNb2RlbCwgbmV4dFZpZXdNb2RlbCB9IGZyb20gJy4vdmlldy1tb2RlbC1jb250cm9scydcbmltcG9ydCB7IGNyZWF0ZUNlbGxWaWV3cywgdXBkYXRlQ2VsbFBvc2l0aW9ucyB9IGZyb20gJy4vdmlldy1jb250cm9scydcbmltcG9ydCB7IENPTlRBSU5FUl9JRCwgQ0VMTF9QUk9QUywgR1VUVEVSIH0gZnJvbSAnLi9jb25zdGFudHMnXG5cbmxldCBhbmltVGltZUludGVyYWxcblxuZnVuY3Rpb24gc3RhcnRBcHAoKSB7XG4gIGNsZWFySW50ZXJ2YWwoYW5pbVRpbWVJbnRlcmFsKVxuICBjb25zdCBST1dTID0gTnVtYmVyKCQoJyNyb3ctY291bnQnKS52YWwoKSlcbiAgY29uc3QgQ09MVU1OUyA9IE51bWJlcigkKCcjY29sdW1uLWNvdW50JykudmFsKCkpXG5cbiAgY29uc3QgY29udGFpbmVyID0gJChDT05UQUlORVJfSUQpXG4gIGNvbnRhaW5lci5lbXB0eSgpXG5cbiAgY29uc3QgeyBjZWxsU2l6ZSB9ID0gQ0VMTF9QUk9QU1xuICBjb250YWluZXIud2lkdGgoKENPTFVNTlMgKiBjZWxsU2l6ZSkgKyAoKENPTFVNTlMgKyAxKSAqIEdVVFRFUikpXG4gIGNvbnRhaW5lci5oZWlnaHQoKFJPV1MgKiBjZWxsU2l6ZSkgKyAoKFJPV1MgKyAxKSAqIEdVVFRFUikpXG5cbiAgY29uc3QgbWF0cml4ID0gZ2VuZXJhdGVNYXRyaXgoUk9XUywgQ09MVU1OUylcbiAgcHJpbnRNYXRyaXgobWF0cml4KVxuICBsZXQgdmlld01vZGVsID0gZ2VuZXJhdGVWaWV3TW9kZWwobWF0cml4KVxuXG4gIGNyZWF0ZUNlbGxWaWV3cyhjb250YWluZXIsIHZpZXdNb2RlbClcblxuICBhbmltVGltZUludGVyYWwgPSBzZXRJbnRlcnZhbCgoKSA9PiB7XG4gICAgdmlld01vZGVsID0gbmV4dFZpZXdNb2RlbCh2aWV3TW9kZWwpXG4gICAgdXBkYXRlQ2VsbFBvc2l0aW9ucyh2aWV3TW9kZWwpXG4gIH0sIDEwMDApXG59XG5cbiQoKCkgPT4ge1xuICBzdGFydEFwcCgpXG5cbiAgY29uc3Qgc3RhcnQgPSAoKSA9PiB7XG4gICAgc3RhcnRBcHAoKVxuICB9XG4gICQoJyNyZXNldCcpLmNsaWNrKHN0YXJ0KVxuXG4gICQoJyNyb3ctY291bnQsICNjb2x1bW4tY291bnQnKS5jaGFuZ2Uoc3RhcnQpXG59KVxuIiwiZXhwb3J0IGNvbnN0IENPTlRBSU5FUl9JRCA9ICcjbWF0cml4LWNvbnRhaW5lcidcblxuZXhwb3J0IGNvbnN0IENFTExfUFJPUFMgPSB7XG4gIGNlbGxUZW1wbGF0ZTogKGNlbGwpID0+IChgPGRpdiBjbGFzcz1cImNlbGxcIj4ke2NlbGwudGV4dH08L2NlbGw+YCksXG4gIGNlbGxTaXplOiAzMCxcbn1cblxuZXhwb3J0IGNvbnN0IEdVVFRFUiA9IDEwXG4iLCJleHBvcnQgZnVuY3Rpb24gZ2VuZXJhdGVNYXRyaXgoUk9XUywgQ09MVU1OUykge1xuICBjb25zdCBtYXRyaXggPSBbXVxuICBsZXQgY291bnQgPSAwXG4gIGZvciAobGV0IGkgPSAwOyBpIDwgUk9XUzsgaSsrKSB7XG4gICAgY29uc3Qgcm93ID0gW11cbiAgICBmb3IgKGxldCBqID0gMDsgaiA8IENPTFVNTlM7IGorKykge1xuICAgICAgcm93LnB1c2goKytjb3VudClcbiAgICB9XG4gICAgbWF0cml4LnB1c2gocm93KVxuICB9XG5cbiAgcmV0dXJuIG1hdHJpeFxufVxuXG5leHBvcnQgZnVuY3Rpb24gcHJpbnRNYXRyaXgobWF0cml4KSB7XG4gIGxldCBzdHIgPSAnJ1xuICBmb3IgKGxldCBpID0gMDsgaSA8IG1hdHJpeC5sZW5ndGg7IGkrKykge1xuICAgIGZvciAobGV0IGogPSAwOyBqIDwgbWF0cml4W2ldLmxlbmd0aDsgaisrKSB7XG4gICAgICBzdHIgKz0gYFxcdCR7bWF0cml4W2ldW2pdfWBcbiAgICB9XG4gICAgc3RyICs9ICdcXG4nXG4gIH1cblxuICByZXR1cm4gc3RyXG59XG4iLCJpbXBvcnQgeyBDRUxMX1BST1BTLCBHVVRURVIgfSBmcm9tICcuL2NvbnN0YW50cydcblxuZnVuY3Rpb24gZ2V0Q2VsbFZpZXdQb3NpdGlvbihjZWxsKSB7XG4gIGNvbnN0IHsgY2VsbFNpemUgfSA9IENFTExfUFJPUFNcbiAgY29uc3QgdG9wID0gKGNlbGwucG9zaXRpb24ueCAqIChjZWxsU2l6ZSArIEdVVFRFUikpICsgKGNlbGwucG9zaXRpb24ueCArIEdVVFRFUilcbiAgY29uc3QgbGVmdCA9IChjZWxsLnBvc2l0aW9uLnkgKiAoY2VsbFNpemUgKyBHVVRURVIpKSArIChjZWxsLnBvc2l0aW9uLnkgKyBHVVRURVIpXG4gIHJldHVybiB7XG4gICAgdG9wOiBgJHt0b3B9cHhgLFxuICAgIGxlZnQ6IGAke2xlZnR9cHhgLFxuICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVDZWxsVmlld3MoY29udGFpbmVyLCB2aWV3TW9kZWwpIHtcbiAgY29uc3QgeyBjZWxsVGVtcGxhdGUgfSA9IENFTExfUFJPUFNcblxuICBmb3IgKGxldCBpID0gMDsgaSA8IHZpZXdNb2RlbC5sZW5ndGg7IGkrKykge1xuICAgIGNvbnN0IGNlbGwgPSB2aWV3TW9kZWxbaV1cbiAgICBjb25zdCBuZXdDZWxsVmlldyA9ICQoY2VsbFRlbXBsYXRlKHsgdGV4dDogY2VsbC50ZXh0IH0pKVxuICAgIG5ld0NlbGxWaWV3LmNzcyhnZXRDZWxsVmlld1Bvc2l0aW9uKGNlbGwpKVxuICAgIG5ld0NlbGxWaWV3LnByb3AoJ2lkJywgY2VsbC5pZClcbiAgICBjb250YWluZXIuYXBwZW5kKG5ld0NlbGxWaWV3KVxuICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiB1cGRhdGVDZWxsUG9zaXRpb25zKHZpZXdNb2RlbCkge1xuICB2aWV3TW9kZWwuZm9yRWFjaCgoY2VsbCkgPT4ge1xuICAgICQoYCMke2NlbGwuaWR9YCkuYW5pbWF0ZShnZXRDZWxsVmlld1Bvc2l0aW9uKGNlbGwpLCA3MDApXG4gIH0pXG59XG4iLCJmdW5jdGlvbiBhZGRFbGVtZW50VG9MaXN0KGxpc3QsIHJvdywgY29sdW1uLCBtYXRyaXgpIHtcbiAgY29uc3QgaGFzRWxlbWVudCA9IGxpc3QuZmluZCgoZWwpID0+IChlbC5pZCA9PT0gYGNlbGwtJHtyb3d9LSR7Y29sdW1ufWApKVxuICBpZiAoIWhhc0VsZW1lbnQpIHtcbiAgICBsaXN0LnB1c2goe1xuICAgICAgaWQ6IGBjZWxsLSR7cm93fS0ke2NvbHVtbn1gLFxuICAgICAgdGV4dDogbWF0cml4W3Jvd11bY29sdW1uXSxcbiAgICAgIHBvc2l0aW9uOiB7XG4gICAgICAgIHg6IHJvdyxcbiAgICAgICAgeTogY29sdW1uLFxuICAgICAgfSxcbiAgICB9KVxuICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZW5lcmF0ZVZpZXdNb2RlbChtYXRyaXgpIHtcbiAgY29uc3QgUk9XUyA9IG1hdHJpeC5sZW5ndGhcbiAgY29uc3QgQ09MVU1OUyA9IG1hdHJpeFswXS5sZW5ndGhcblxuICBjb25zdCBudW1iZXJPZkNpcmNsZXMgPSBNYXRoLmNlaWwoTWF0aC5taW4oUk9XUywgQ09MVU1OUykgLyAyKVxuXG4gIGxldCBhbGxDaXJjbGVFbGVtZW50cyA9IFtdXG4gIGxldCByb3dcbiAgbGV0IGNvbHVtblxuXG4gIGZvciAobGV0IGNpcmNsZSA9IDA7IGNpcmNsZSA8IG51bWJlck9mQ2lyY2xlczsgY2lyY2xlKyspIHtcbiAgICBjb25zdCBjaXJjbGVFbGVtZW50cyA9IFtdXG5cbiAgICAvLyBUb3AgRWRnZVxuICAgIC8qXG4gICAgICAsX19fX19fX19fX19fX19fX19fX18sXG4gICAgICB8ICAwMCAgICAwMSAgIDAyIHwgIDAzXG4gICAgICAnLS0tLS0tLS0tLS0tLS0tLS0tLS0nXG4gICAgICAxMCAgICAxMSAgIDEyICAgIDEzXG4gICAgICAyMCAgICAyMSAgIDIyICAgIDIzXG4gICAgICAzMCAgICAzMSAgIDMyICAgIDMzXG4gICAgKi9cbiAgICByb3cgPSBjaXJjbGVcbiAgICBmb3IgKGNvbHVtbiA9IGNpcmNsZTsgY29sdW1uIDwgQ09MVU1OUyAtIGNpcmNsZSAtIDE7IGNvbHVtbisrKSB7XG4gICAgICBhZGRFbGVtZW50VG9MaXN0KGNpcmNsZUVsZW1lbnRzLCByb3csIGNvbHVtbiwgbWF0cml4KVxuICAgIH1cblxuICAgIC8vIFJpZ2h0IEVkZ2VcbiAgICAvKlxuICAgICAgICAgICAgICAgICxfX19fXyxcbiAgICAgIDAwICAgIDAxICAgMDIgICB8ICAwMyB8XG4gICAgICAxMCAgICAxMSAgIDEyICAgfCAgMTMgfFxuICAgICAgMjAgICAgMjEgICAyMiAgIHwgIDIzIHxcbiAgICAgICAgICAgICAgICBgLS0tLS0nXG4gICAgICAzMCAgICAzMSAgIDMyICAgIDMzXG4gICAgKi9cbiAgICBjb2x1bW4gPSBDT0xVTU5TIC0gY2lyY2xlIC0gMVxuICAgIGZvciAocm93ID0gY2lyY2xlOyByb3cgPCBST1dTIC0gY2lyY2xlIC0gMTsgcm93KyspIHtcbiAgICAgIGFkZEVsZW1lbnRUb0xpc3QoY2lyY2xlRWxlbWVudHMsIHJvdywgY29sdW1uLCBtYXRyaXgpXG4gICAgfVxuXG4gICAgLy8gQm90dG9tIEVkZ2VcbiAgICAvKlxuICAgICAgMDAgICAgMDEgICAwMiAgICAwM1xuICAgICAgMTAgICAgMTEgICAxMiAgICAxM1xuICAgICAgMjAgICAgMjEgICAyMiAgICAyM1xuICAgICAgICAgICxfX19fX19fX19fX19fX19fX19fXyxcbiAgICAgIDMwICB8ICAzMSAgIDMyICAgIDMzIHxcbiAgICAgICAgICBgLS0tLS0tLS0tLS0tLS0tLS0tLS0nXG4gICAgKi9cbiAgICByb3cgPSBST1dTIC0gY2lyY2xlIC0gMVxuICAgIGZvciAoY29sdW1uID0gQ09MVU1OUyAtIGNpcmNsZSAtIDE7IGNvbHVtbiA+IGNpcmNsZTsgY29sdW1uLS0pIHtcbiAgICAgIGFkZEVsZW1lbnRUb0xpc3QoY2lyY2xlRWxlbWVudHMsIHJvdywgY29sdW1uLCBtYXRyaXgpXG4gICAgfVxuXG4gICAgLy8gTGVmdCBFZGdlXG4gICAgLypcbiAgICAgIDAwICAgIDAxICAgMDIgICAgMDNcbiAgICAgICxfX19fLFxuICAgICAgfCAxMCB8ICAgMTEgICAxMiAgICAxM1xuICAgICAgfCAyMCB8ICAgMjEgICAyMiAgICAyM1xuICAgICAgfCAzMCB8ICAgMzEgICAzMiAgICAzM1xuICAgICAgJy0tLS0nXG4gICAgKi9cbiAgICBjb2x1bW4gPSBjaXJjbGVcbiAgICBmb3IgKHJvdyA9IFJPV1MgLSBjaXJjbGUgLSAxOyByb3cgPiBjaXJjbGU7IHJvdy0tKSB7XG4gICAgICBhZGRFbGVtZW50VG9MaXN0KGNpcmNsZUVsZW1lbnRzLCByb3csIGNvbHVtbiwgbWF0cml4KVxuICAgIH1cblxuICAgIC8vIENlbnRlciBjZWxsXG4gICAgaWYgKFJPV1MgPT09IENPTFVNTlMgJiYgUk9XUyAlIDIgPT09IDEgJiYgY2lyY2xlID09PSBudW1iZXJPZkNpcmNsZXMgLSAxKSB7XG4gICAgICBhZGRFbGVtZW50VG9MaXN0KGNpcmNsZUVsZW1lbnRzLCByb3csIGNvbHVtbiwgbWF0cml4KVxuICAgIH1cblxuICAgIC8vIE1hcHBpbmcgbmV4dCBhbmQgcHJldiBub2Rlc1xuICAgIGNpcmNsZUVsZW1lbnRzLmZvckVhY2goKGVsLCBpZHgpID0+IHtcbiAgICAgIGNvbnN0IGNlbGwgPSBlbFxuICAgICAgaWYgKGNlbGwuZGlzYmxlQW5pbWF0aW9ucykge1xuICAgICAgICBjZWxsLm5leHRQb3NpdGlvbiA9IGVsLnBvc2l0aW9uXG4gICAgICAgIGNlbGwucHJldlBvc2l0aW9uID0gZWwucG9zaXRpb25cbiAgICAgIH1cblxuICAgICAgY2VsbC5uZXh0UG9zaXRpb24gPSBjaXJjbGVFbGVtZW50c1soaWR4ICsgMSkgJSBjaXJjbGVFbGVtZW50cy5sZW5ndGhdLnBvc2l0aW9uXG4gICAgICBjZWxsLnByZXZQb3NpdGlvbiA9IGNpcmNsZUVsZW1lbnRzW01hdGguYWJzKGNpcmNsZUVsZW1lbnRzLmxlbmd0aCArIGlkeCAtIDEpICUgY2lyY2xlRWxlbWVudHMubGVuZ3RoXS5wb3NpdGlvblxuICAgIH0pXG5cbiAgICBhbGxDaXJjbGVFbGVtZW50cyA9IGFsbENpcmNsZUVsZW1lbnRzLmNvbmNhdChjaXJjbGVFbGVtZW50cylcbiAgfVxuXG4gIHJldHVybiBhbGxDaXJjbGVFbGVtZW50c1xufVxuXG5leHBvcnQgZnVuY3Rpb24gbmV4dFZpZXdNb2RlbChtb2RlbCkge1xuICBjb25zdCBuZXh0TW9kZWwgPSBtb2RlbC5tYXAoKGl0ZW0pID0+IHtcbiAgICBsZXQgbmV4dEVsZW1lbnQgPSBtb2RlbC5maW5kKChlbCkgPT4gKFIuZXF1YWxzKGVsLnBvc2l0aW9uLCBpdGVtLm5leHRQb3NpdGlvbikpKVxuICAgIG5leHRFbGVtZW50ID0gUi5jbG9uZShuZXh0RWxlbWVudClcbiAgICBuZXh0RWxlbWVudC50ZXh0ID0gaXRlbS50ZXh0XG4gICAgbmV4dEVsZW1lbnQuaWQgPSBpdGVtLmlkXG4gICAgcmV0dXJuIG5leHRFbGVtZW50XG4gIH0pXG5cbiAgcmV0dXJuIG5leHRNb2RlbFxufVxuIl19
