(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
"use strict";

var _modelControls = require("./model-controls");

var generateMatrix = _modelControls.generateMatrix;
var printMatrix = _modelControls.printMatrix;

var _viewModelControls = require("./view-model-controls");

var generateViewModel = _viewModelControls.generateViewModel;
var nextViewModel = _viewModelControls.nextViewModel;

var _viewControls = require("./view-controls");

var createCellViews = _viewControls.createCellViews;
var updateCellPositions = _viewControls.updateCellPositions;

var _constants = require("./constants");

var CONTAINER_ID = _constants.CONTAINER_ID;
var CELL_PROPS = _constants.CELL_PROPS;
var GUTTER = _constants.GUTTER;

var animTimeInteral = undefined;

function startApp() {
  clearInterval(animTimeInteral);
  var ROWS = Number($("#row-count").val());
  var COLUMNS = Number($("#column-count").val());

  var container = $(CONTAINER_ID);
  container.empty();

  var cellSize = CELL_PROPS.cellSize;

  container.width(COLUMNS * cellSize + (COLUMNS + 1) * GUTTER);
  container.height(ROWS * cellSize + (ROWS + 1) * GUTTER);

  var matrix = generateMatrix(ROWS, COLUMNS);
  printMatrix(matrix);
  var viewModel = generateViewModel(matrix);

  createCellViews(container, viewModel);

  animTimeInteral = setInterval(function () {
    viewModel = nextViewModel(viewModel);
    updateCellPositions(viewModel);
  }, 1000);
}

$(function () {
  startApp();

  var start = function () {
    startApp();
  };
  $("#reset").click(start);

  $("#row-count, #column-count").change(start);
});

},{"./constants":2,"./model-controls":3,"./view-controls":4,"./view-model-controls":5}],2:[function(require,module,exports){
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
var CONTAINER_ID = "#matrix-container";

exports.CONTAINER_ID = CONTAINER_ID;
var CELL_PROPS = {
  cellTemplate: function (cell) {
    return "<div class=\"cell\">" + cell.text + "</cell>";
  },
  cellSize: 30 };

exports.CELL_PROPS = CELL_PROPS;
var GUTTER = 10;
exports.GUTTER = GUTTER;

},{}],3:[function(require,module,exports){
"use strict";

exports.generateMatrix = generateMatrix;
exports.printMatrix = printMatrix;
Object.defineProperty(exports, "__esModule", {
  value: true
});

function generateMatrix(ROWS, COLUMNS) {
  var matrix = [];
  var count = 0;
  for (var i = 0; i < ROWS; i++) {
    var row = [];
    for (var j = 0; j < COLUMNS; j++) {
      row.push(++count);
    }
    matrix.push(row);
  }

  return matrix;
}

function printMatrix(matrix) {
  var str = "";
  for (var i = 0; i < matrix.length; i++) {
    for (var j = 0; j < matrix[i].length; j++) {
      str += "\t" + matrix[i][j];
    }
    str += "\n";
  }

  return str;
}

},{}],4:[function(require,module,exports){
"use strict";

exports.createCellViews = createCellViews;
exports.updateCellPositions = updateCellPositions;
Object.defineProperty(exports, "__esModule", {
  value: true
});

var _constants = require("./constants");

var CELL_PROPS = _constants.CELL_PROPS;
var GUTTER = _constants.GUTTER;

function getCellViewPosition(cell) {
  var cellSize = CELL_PROPS.cellSize;

  var top = cellSize * cell.position.x + (cell.position.x + 1) * GUTTER;
  var left = cellSize * cell.position.y + (cell.position.y + 1) * GUTTER;
  return {
    top: "" + top + "px",
    left: "" + left + "px" };
}

function createCellViews(container, viewModel) {
  var cellTemplate = CELL_PROPS.cellTemplate;

  for (var i = 0; i < viewModel.length; i++) {
    var cell = viewModel[i];
    var newCellView = $(cellTemplate({ text: cell.text }));
    newCellView.css(getCellViewPosition(cell));
    newCellView.prop("id", cell.id);
    container.append(newCellView);
  }
}

function updateCellPositions(viewModel) {
  viewModel.forEach(function (cell) {
    $("#" + cell.id).animate(getCellViewPosition(cell), 700);
  });
}

},{"./constants":2}],5:[function(require,module,exports){
"use strict";

exports.generateViewModel = generateViewModel;
exports.nextViewModel = nextViewModel;
Object.defineProperty(exports, "__esModule", {
  value: true
});
function addElementToList(list, row, column, matrix) {
  var hasElement = list.find(function (el) {
    return el.id === "cell-" + row + "-" + column;
  });
  if (!hasElement) {
    list.push({
      id: "cell-" + row + "-" + column,
      text: matrix[row][column],
      position: {
        x: row,
        y: column } });
  }
}

function generateViewModel(matrix) {
  var ROWS = matrix.length;
  var COLUMNS = matrix[0].length;

  var numberOfCircles = Math.ceil(Math.min(ROWS, COLUMNS) / 2);

  var allCircleElements = [];
  var row = undefined;
  var column = undefined;

  for (var circle = 0; circle < numberOfCircles; circle++) {
    (function (circle) {
      var circleElements = [];

      // Top Edge
      /*
        ,________________,
        |  00    01   02 |  03
        '----------------'
           10    11   12    13
           20    21   22    23
           30    31   32    33
      */
      row = circle;
      for (column = circle; column < COLUMNS - circle - 1; column++) {
        addElementToList(circleElements, row, column, matrix);
      }

      // Right Edge
      /*
                        ,_____,
        00    01   02   |  03 |
        10    11   12   |  13 |
        20    21   22   |  23 |
                        `-----'
        30    31   32    33
      */
      column = COLUMNS - circle - 1;
      for (row = circle; row < ROWS - circle - 1; row++) {
        addElementToList(circleElements, row, column, matrix);
      }

      // Bottom Edge
      /*
        00    01   02    03
        10    11   12    13
        20    21   22    23
            ,________________,
        30  |  31   32    33 |
            `----------------'
      */
      row = ROWS - circle - 1;
      for (column = COLUMNS - circle - 1; column > circle; column--) {
        addElementToList(circleElements, row, column, matrix);
      }

      // Left Edge
      /*
          00     01   02    03
        ,____,
        | 10 |   11   12    13
        | 20 |   21   22    23
        | 30 |   31   32    33
        '----'
      */
      column = circle;
      for (row = ROWS - circle - 1; row > circle; row--) {
        addElementToList(circleElements, row, column, matrix);
      }

      // Center cell
      if (ROWS === COLUMNS && ROWS % 2 === 1 && circle === numberOfCircles - 1) {
        addElementToList(circleElements, row, column, matrix);
      }

      // Mapping next and prev nodes
      circleElements.forEach(function (el, idx) {
        var cell = el;
        if (cell.disbleAnimations) {
          cell.nextPosition = el.position;
          cell.prevPosition = el.position;
        }

        cell.nextPosition = circleElements[(idx + 1) % circleElements.length].position;
        cell.prevPosition = circleElements[Math.abs(circleElements.length + idx - 1) % circleElements.length].position;
      });

      allCircleElements = allCircleElements.concat(circleElements);
    })(circle);
  }

  return allCircleElements;
}

function nextViewModel(model) {
  var nextModel = model.map(function (item) {
    var nextElement = model.find(function (el) {
      return R.equals(el.position, item.nextPosition);
    });
    nextElement = R.clone(nextElement);
    nextElement.text = item.text;
    nextElement.id = item.id;
    return nextElement;
  });

  return nextModel;
}

},{}]},{},[1])
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCIvbWVkaWEvc2FyYXZhbi9BNEFDNjE2Q0FDNjEzQTQ2L3dvcmsgYXJlYS9HSVQvbWF0cml4LWFuaW0tanF1ZXJ5L3NyYy9hcHAuanMiLCIvbWVkaWEvc2FyYXZhbi9BNEFDNjE2Q0FDNjEzQTQ2L3dvcmsgYXJlYS9HSVQvbWF0cml4LWFuaW0tanF1ZXJ5L3NyYy9jb25zdGFudHMuanMiLCIvbWVkaWEvc2FyYXZhbi9BNEFDNjE2Q0FDNjEzQTQ2L3dvcmsgYXJlYS9HSVQvbWF0cml4LWFuaW0tanF1ZXJ5L3NyYy9tb2RlbC1jb250cm9scy5qcyIsIi9tZWRpYS9zYXJhdmFuL0E0QUM2MTZDQUM2MTNBNDYvd29yayBhcmVhL0dJVC9tYXRyaXgtYW5pbS1qcXVlcnkvc3JjL3ZpZXctY29udHJvbHMuanMiLCIvbWVkaWEvc2FyYXZhbi9BNEFDNjE2Q0FDNjEzQTQ2L3dvcmsgYXJlYS9HSVQvbWF0cml4LWFuaW0tanF1ZXJ5L3NyYy92aWV3LW1vZGVsLWNvbnRyb2xzLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBOzs7NkJDQTRDLGtCQUFrQjs7SUFBckQsY0FBYyxrQkFBZCxjQUFjO0lBQUUsV0FBVyxrQkFBWCxXQUFXOztpQ0FDYSx1QkFBdUI7O0lBQS9ELGlCQUFpQixzQkFBakIsaUJBQWlCO0lBQUUsYUFBYSxzQkFBYixhQUFhOzs0QkFDWSxpQkFBaUI7O0lBQTdELGVBQWUsaUJBQWYsZUFBZTtJQUFFLG1CQUFtQixpQkFBbkIsbUJBQW1COzt5QkFDSSxhQUFhOztJQUFyRCxZQUFZLGNBQVosWUFBWTtJQUFFLFVBQVUsY0FBVixVQUFVO0lBQUUsTUFBTSxjQUFOLE1BQU07O0FBRXpDLElBQUksZUFBZSxZQUFBLENBQUE7O0FBRW5CLFNBQVMsUUFBUSxHQUFHO0FBQ2xCLGVBQWEsQ0FBQyxlQUFlLENBQUMsQ0FBQTtBQUM5QixNQUFNLElBQUksR0FBRyxNQUFNLENBQUMsQ0FB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QWMsQ0FBQyxNQUFNLEdBQUcsR0FBRyxHQUFHLENBQUMsQ0FBQyxHQUFHLGNBQWMsQ0FBQyxNQUFNLENBQUMsQ0FBQyxRQUFRLENBQUE7T0FDL0csQ0FBQyxDQUFBOztBQUVGLHVCQUFpQixHQUFHLGlCQUFpQixDQUFDLE1BQU0sQ0FBQyxjQUFjLENBQUMsQ0FBQTtPQTVFckQsTUFBTTtHQTZFZDs7QUFFRCxTQUFPLGlCQUFpQixDQUFBO0NBQ3pCOztBQUVNLFNBQVMsYUFBYSxDQUFDLEtBQUssRUFBRTtBQUNuQyxNQUFNLFNBQVMsR0FBRyxLQUFLLENBQUMsR0FBRyxDQUFDLFVBQUMsSUFBSSxFQUFLO0FBQ3BDLFFBQUksV0FBVyxHQUFHLEtBQUssQ0FBQyxJQUFJLENBQUMsVUFBQyxFQUFFO2FBQU0sQ0FBQyxDQUFDLE1BQU0sQ0FBQyxFQUFFLENBQUMsUUFBUSxFQUFFLElBQUksQ0FBQyxZQUFZLENBQUM7S0FBQyxDQUFDLENBQUE7QUFDaEYsZUFBVyxHQUFHLENBQUMsQ0FBQyxLQUFLLENBQUMsV0FBVyxDQUFDLENBQUE7QUFDbEMsZUFBVyxDQUFDLElBQUksR0FBRyxJQUFJLENBQUMsSUFBSSxDQUFBO0FBQzVCLGVBQVcsQ0FBQyxFQUFFLEdBQUcsSUFBSSxDQUFDLEVBQUUsQ0FBQTtBQUN4QixXQUFPLFdBQVcsQ0FBQTtHQUNuQixDQUFDLENBQUE7O0FBRUYsU0FBTyxTQUFTLENBQUE7Q0FDakIiLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiBlKHQsbixyKXtmdW5jdGlvbiBzKG8sdSl7aWYoIW5bb10pe2lmKCF0W29dKXt2YXIgYT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2lmKCF1JiZhKXJldHVybiBhKG8sITApO2lmKGkpcmV0dXJuIGkobywhMCk7dmFyIGY9bmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitvK1wiJ1wiKTt0aHJvdyBmLmNvZGU9XCJNT0RVTEVfTk9UX0ZPVU5EXCIsZn12YXIgbD1uW29dPXtleHBvcnRzOnt9fTt0W29dWzBdLmNhbGwobC5leHBvcnRzLGZ1bmN0aW9uKGUpe3ZhciBuPXRbb11bMV1bZV07cmV0dXJuIHMobj9uOmUpfSxsLGwuZXhwb3J0cyxlLHQsbixyKX1yZXR1cm4gbltvXS5leHBvcnRzfXZhciBpPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7Zm9yKHZhciBvPTA7bzxyLmxlbmd0aDtvKyspcyhyW29dKTtyZXR1cm4gc30pIiwiaW1wb3J0IHsgZ2VuZXJhdGVNYXRyaXgsIHByaW50TWF0cml4IH0gZnJvbSAnLi9tb2RlbC1jb250cm9scydcbmltcG9ydCB7IGdlbmVyYXRlVmlld01vZGVsLCBuZXh0Vmlld01vZGVsIH0gZnJvbSAnLi92aWV3LW1vZGVsLWNvbnRyb2xzJ1xuaW1wb3J0IHsgY3JlYXRlQ2VsbFZpZXdzLCB1cGRhdGVDZWxsUG9zaXRpb25zIH0gZnJvbSAnLi92aWV3LWNvbnRyb2xzJ1xuaW1wb3J0IHsgQ09OVEFJTkVSX0lELCBDRUxMX1BST1BTLCBHVVRURVIgfSBmcm9tICcuL2NvbnN0YW50cydcblxubGV0IGFuaW1UaW1lSW50ZXJhbFxuXG5mdW5jdGlvbiBzdGFydEFwcCgpIHtcbiAgY2xlYXJJbnRlcnZhbChhbmltVGltZUludGVyYWwpXG4gIGNvbnN0IFJPV1MgPSBOdW1iZXIoJCgnI3Jvdy1jb3VudCcpLnZhbCgpKVxuICBjb25zdCBDT0xVTU5TID0gTnVtYmVyKCQoJyNjb2x1bW4tY291bnQnKS52YWwoKSlcblxuICBjb25zdCBjb250YWluZXIgPSAkKENPTlRBSU5FUl9JRClcbiAgY29udGFpbmVyLmVtcHR5KClcblxuICBjb25zdCB7IGNlbGxTaXplIH0gPSBDRUxMX1BST1BTXG4gIGNvbnRhaW5lci53aWR0aCgoQ09MVU1OUyAqIGNlbGxTaXplKSArICgoQ09MVU1OUyArIDEpICogR1VUVEVSKSlcbiAgY29udGFpbmVyLmhlaWdodCgoUk9XUyAqIGNlbGxTaXplKSArICgoUk9XUyArIDEpICogR1VUVEVSKSlcblxuICBjb25zdCBtYXRyaXggPSBnZW5lcmF0ZU1hdHJpeChST1dTLCBDT0xVTU5TKVxuICBwcmludE1hdHJpeChtYXRyaXgpXG4gIGxldCB2aWV3TW9kZWwgPSBnZW5lcmF0ZVZpZXdNb2RlbChtYXRyaXgpXG5cbiAgY3JlYXRlQ2VsbFZpZXdzKGNvbnRhaW5lciwgdmlld01vZGVsKVxuXG4gIGFuaW1UaW1lSW50ZXJhbCA9IHNldEludGVydmFsKCgpID0+IHtcbiAgICB2aWV3TW9kZWwgPSBuZXh0Vmlld01vZGVsKHZpZXdNb2RlbClcbiAgICB1cGRhdGVDZWxsUG9zaXRpb25zKHZpZXdNb2RlbClcbiAgfSwgMTAwMClcbn1cblxuJCgoKSA9PiB7XG4gIHN0YXJ0QXBwKClcblxuICBjb25zdCBzdGFydCA9ICgpID0+IHtcbiAgICBzdGFydEFwcCgpXG4gIH1cbiAgJCgnI3Jlc2V0JykuY2xpY2soc3RhcnQpXG5cbiAgJCgnI3Jvdy1jb3VudCwgI2NvbHVtbi1jb3VudCcpLmNoYW5nZShzdGFydClcbn0pXG4iLCJleHBvcnQgY29uc3QgQ09OVEFJTkVSX0lEID0gJyNtYXRyaXgtY29udGFpbmVyJ1xuXG5leHBvcnQgY29uc3QgQ0VMTF9QUk9QUyA9IHtcbiAgY2VsbFRlbXBsYXRlOiAoY2VsbCkgPT4gKGA8ZGl2IGNsYXNzPVwiY2VsbFwiPiR7Y2VsbC50ZXh0fTwvY2VsbD5gKSxcbiAgY2VsbFNpemU6IDMwLFxufVxuXG5leHBvcnQgY29uc3QgR1VUVEVSID0gMTBcbiIsImV4cG9ydCBmdW5jdGlvbiBnZW5lcmF0ZU1hdHJpeChST1dTLCBDT0xVTU5TKSB7XG4gIGNvbnN0IG1hdHJpeCA9IFtdXG4gIGxldCBjb3VudCA9IDBcbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBST1dTOyBpKyspIHtcbiAgICBjb25zdCByb3cgPSBbXVxuICAgIGZvciAobGV0IGogPSAwOyBqIDwgQ09MVU1OUzsgaisrKSB7XG4gICAgICByb3cucHVzaCgrK2NvdW50KVxuICAgIH1cbiAgICBtYXRyaXgucHVzaChyb3cpXG4gIH1cblxuICByZXR1cm4gbWF0cml4XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBwcmludE1hdHJpeChtYXRyaXgpIHtcbiAgbGV0IHN0ciA9ICcnXG4gIGZvciAobGV0IGkgPSAwOyBpIDwgbWF0cml4Lmxlbmd0aDsgaSsrKSB7XG4gICAgZm9yIChsZXQgaiA9IDA7IGogPCBtYXRyaXhbaV0ubGVuZ3RoOyBqKyspIHtcbiAgICAgIHN0ciArPSBgXFx0JHttYXRyaXhbaV1bal19YFxuICAgIH1cbiAgICBzdHIgKz0gJ1xcbidcbiAgfVxuXG4gIHJldHVybiBzdHJcbn1cbiIsImltcG9ydCB7IENFTExfUFJPUFMsIEdVVFRFUiB9IGZyb20gJy4vY29uc3RhbnRzJ1xuXG5mdW5jdGlvbiBnZXRDZWxsVmlld1Bvc2l0aW9uKGNlbGwpIHtcbiAgY29uc3QgeyBjZWxsU2l6ZSB9ID0gQ0VMTF9QUk9QU1xuICBjb25zdCB0b3AgPSAgKGNlbGxTaXplICogY2VsbC5wb3NpdGlvbi54KSArICgoY2VsbC5wb3NpdGlvbi54ICsgMSApICogR1VUVEVSKVxuICBjb25zdCBsZWZ0ID0gKGNlbGxTaXplICogY2VsbC5wb3NpdGlvbi55KSArICgoY2VsbC5wb3NpdGlvbi55ICsgMSApICogR1VUVEVSKVxuICByZXR1cm4ge1xuICAgIHRvcDogYCR7dG9wfXB4YCxcbiAgICBsZWZ0OiBgJHtsZWZ0fXB4YCxcbiAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlQ2VsbFZpZXdzKGNvbnRhaW5lciwgdmlld01vZGVsKSB7XG4gIGNvbnN0IHsgY2VsbFRlbXBsYXRlIH0gPSBDRUxMX1BST1BTXG5cbiAgZm9yIChsZXQgaSA9IDA7IGkgPCB2aWV3TW9kZWwubGVuZ3RoOyBpKyspIHtcbiAgICBjb25zdCBjZWxsID0gdmlld01vZGVsW2ldXG4gICAgY29uc3QgbmV3Q2VsbFZpZXcgPSAkKGNlbGxUZW1wbGF0ZSh7IHRleHQ6IGNlbGwudGV4dCB9KSlcbiAgICBuZXdDZWxsVmlldy5jc3MoZ2V0Q2VsbFZpZXdQb3NpdGlvbihjZWxsKSlcbiAgICBuZXdDZWxsVmlldy5wcm9wKCdpZCcsIGNlbGwuaWQpXG4gICAgY29udGFpbmVyLmFwcGVuZChuZXdDZWxsVmlldylcbiAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gdXBkYXRlQ2VsbFBvc2l0aW9ucyh2aWV3TW9kZWwpIHtcbiAgdmlld01vZGVsLmZvckVhY2goKGNlbGwpID0+IHtcbiAgICAkKGAjJHtjZWxsLmlkfWApLmFuaW1hdGUoZ2V0Q2VsbFZpZXdQb3NpdGlvbihjZWxsKSwgNzAwKVxuICB9KVxufVxuIiwiZnVuY3Rpb24gYWRkRWxlbWVudFRvTGlzdChsaXN0LCByb3csIGNvbHVtbiwgbWF0cml4KSB7XG4gIGNvbnN0IGhhc0VsZW1lbnQgPSBsaXN0LmZpbmQoKGVsKSA9PiAoZWwuaWQgPT09IGBjZWxsLSR7cm93fS0ke2NvbHVtbn1gKSlcbiAgaWYgKCFoYXNFbGVtZW50KSB7XG4gICAgbGlzdC5wdXNoKHtcbiAgICAgIGlkOiBgY2VsbC0ke3Jvd30tJHtjb2x1bW59YCxcbiAgICAgIHRleHQ6IG1hdHJpeFtyb3ddW2NvbHVtbl0sXG4gICAgICBwb3NpdGlvbjoge1xuICAgICAgICB4OiByb3csXG4gICAgICAgIHk6IGNvbHVtbixcbiAgICAgIH0sXG4gICAgfSlcbiAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2VuZXJhdGVWaWV3TW9kZWwobWF0cml4KSB7XG4gIGNvbnN0IFJPV1MgPSBtYXRyaXgubGVuZ3RoXG4gIGNvbnN0IENPTFVNTlMgPSBtYXRyaXhbMF0ubGVuZ3RoXG5cbiAgY29uc3QgbnVtYmVyT2ZDaXJjbGVzID0gTWF0aC5jZWlsKE1hdGgubWluKFJPV1MsIENPTFVNTlMpIC8gMilcblxuICBsZXQgYWxsQ2lyY2xlRWxlbWVudHMgPSBbXVxuICBsZXQgcm93XG4gIGxldCBjb2x1bW5cblxuICBmb3IgKGxldCBjaXJjbGUgPSAwOyBjaXJjbGUgPCBudW1iZXJPZkNpcmNsZXM7IGNpcmNsZSsrKSB7XG4gICAgY29uc3QgY2lyY2xlRWxlbWVudHMgPSBbXVxuXG4gICAgLy8gVG9wIEVkZ2VcbiAgICAvKlxuICAgICAgLF9fX19fX19fX19fX19fX18sXG4gICAgICB8ICAwMCAgICAwMSAgIDAyIHwgIDAzXG4gICAgICAnLS0tLS0tLS0tLS0tLS0tLSdcbiAgICAgICAgIDEwICAgIDExICAgMTIgICAgMTNcbiAgICAgICAgIDIwICAgIDIxICAgMjIgICAgMjNcbiAgICAgICAgIDMwICAgIDMxICAgMzIgICAgMzNcbiAgICAqL1xuICAgIHJvdyA9IGNpcmNsZVxuICAgIGZvciAoY29sdW1uID0gY2lyY2xlOyBjb2x1bW4gPCBDT0xVTU5TIC0gY2lyY2xlIC0gMTsgY29sdW1uKyspIHtcbiAgICAgIGFkZEVsZW1lbnRUb0xpc3QoY2lyY2xlRWxlbWVudHMsIHJvdywgY29sdW1uLCBtYXRyaXgpXG4gICAgfVxuXG4gICAgLy8gUmlnaHQgRWRnZVxuICAgIC8qXG4gICAgICAgICAgICAgICAgICAgICAgLF9fX19fLFxuICAgICAgMDAgICAgMDEgICAwMiAgIHwgIDAzIHxcbiAgICAgIDEwICAgIDExICAgMTIgICB8ICAxMyB8XG4gICAgICAyMCAgICAyMSAgIDIyICAgfCAgMjMgfFxuICAgICAgICAgICAgICAgICAgICAgIGAtLS0tLSdcbiAgICAgIDMwICAgIDMxICAgMzIgICAgMzNcbiAgICAqL1xuICAgIGNvbHVtbiA9IENPTFVNTlMgLSBjaXJjbGUgLSAxXG4gICAgZm9yIChyb3cgPSBjaXJjbGU7IHJvdyA8IFJPV1MgLSBjaXJjbGUgLSAxOyByb3crKykge1xuICAgICAgYWRkRWxlbWVudFRvTGlzdChjaXJjbGVFbGVtZW50cywgcm93LCBjb2x1bW4sIG1hdHJpeClcbiAgICB9XG5cbiAgICAvLyBCb3R0b20gRWRnZVxuICAgIC8qXG4gICAgICAwMCAgICAwMSAgIDAyICAgIDAzXG4gICAgICAxMCAgICAxMSAgIDEyICAgIDEzXG4gICAgICAyMCAgICAyMSAgIDIyICAgIDIzXG4gICAgICAgICAgLF9fX19fX19fX19fX19fX18sXG4gICAgICAzMCAgfCAgMzEgICAzMiAgICAzMyB8XG4gICAgICAgICAgYC0tLS0tLS0tLS0tLS0tLS0nXG4gICAgKi9cbiAgICByb3cgPSBST1dTIC0gY2lyY2xlIC0gMVxuICAgIGZvciAoY29sdW1uID0gQ09MVU1OUyAtIGNpcmNsZSAtIDE7IGNvbHVtbiA+IGNpcmNsZTsgY29sdW1uLS0pIHtcbiAgICAgIGFkZEVsZW1lbnRUb0xpc3QoY2lyY2xlRWxlbWVudHMsIHJvdywgY29sdW1uLCBtYXRyaXgpXG4gICAgfVxuXG4gICAgLy8gTGVmdCBFZGdlXG4gICAgLypcbiAgICAgICAgMDAgICAgIDAxICAgMDIgICAgMDNcbiAgICAgICxfX19fLFxuICAgICAgfCAxMCB8ICAgMTEgICAxMiAgICAxM1xuICAgICAgfCAyMCB8ICAgMjEgICAyMiAgICAyM1xuICAgICAgfCAzMCB8ICAgMzEgICAzMiAgICAzM1xuICAgICAgJy0tLS0nXG4gICAgKi9cbiAgICBjb2x1bW4gPSBjaXJjbGVcbiAgICBmb3IgKHJvdyA9IFJPV1MgLSBjaXJjbGUgLSAxOyByb3cgPiBjaXJjbGU7IHJvdy0tKSB7XG4gICAgICBhZGRFbGVtZW50VG9MaXN0KGNpcmNsZUVsZW1lbnRzLCByb3csIGNvbHVtbiwgbWF0cml4KVxuICAgIH1cblxuICAgIC8vIENlbnRlciBjZWxsXG4gICAgaWYgKFJPV1MgPT09IENPTFVNTlMgJiYgUk9XUyAlIDIgPT09IDEgJiYgY2lyY2xlID09PSBudW1iZXJPZkNpcmNsZXMgLSAxKSB7XG4gICAgICBhZGRFbGVtZW50VG9MaXN0KGNpcmNsZUVsZW1lbnRzLCByb3csIGNvbHVtbiwgbWF0cml4KVxuICAgIH1cblxuICAgIC8vIE1hcHBpbmcgbmV4dCBhbmQgcHJldiBub2Rlc1xuICAgIGNpcmNsZUVsZW1lbnRzLmZvckVhY2goKGVsLCBpZHgpID0+IHtcbiAgICAgIGNvbnN0IGNlbGwgPSBlbFxuICAgICAgaWYgKGNlbGwuZGlzYmxlQW5pbWF0aW9ucykge1xuICAgICAgICBjZWxsLm5leHRQb3NpdGlvbiA9IGVsLnBvc2l0aW9uXG4gICAgICAgIGNlbGwucHJldlBvc2l0aW9uID0gZWwucG9zaXRpb25cbiAgICAgIH1cblxuICAgICAgY2VsbC5uZXh0UG9zaXRpb24gPSBjaXJjbGVFbGVtZW50c1soaWR4ICsgMSkgJSBjaXJjbGVFbGVtZW50cy5sZW5ndGhdLnBvc2l0aW9uXG4gICAgICBjZWxsLnByZXZQb3NpdGlvbiA9IGNpcmNsZUVsZW1lbnRzW01hdGguYWJzKGNpcmNsZUVsZW1lbnRzLmxlbmd0aCArIGlkeCAtIDEpICUgY2lyY2xlRWxlbWVudHMubGVuZ3RoXS5wb3NpdGlvblxuICAgIH0pXG5cbiAgICBhbGxDaXJjbGVFbGVtZW50cyA9IGFsbENpcmNsZUVsZW1lbnRzLmNvbmNhdChjaXJjbGVFbGVtZW50cylcbiAgfVxuXG4gIHJldHVybiBhbGxDaXJjbGVFbGVtZW50c1xufVxuXG5leHBvcnQgZnVuY3Rpb24gbmV4dFZpZXdNb2RlbChtb2RlbCkge1xuICBjb25zdCBuZXh0TW9kZWwgPSBtb2RlbC5tYXAoKGl0ZW0pID0+IHtcbiAgICBsZXQgbmV4dEVsZW1lbnQgPSBtb2RlbC5maW5kKChlbCkgPT4gKFIuZXF1YWxzKGVsLnBvc2l0aW9uLCBpdGVtLm5leHRQb3NpdGlvbikpKVxuICAgIG5leHRFbGVtZW50ID0gUi5jbG9uZShuZXh0RWxlbWVudClcbiAgICBuZXh0RWxlbWVudC50ZXh0ID0gaXRlbS50ZXh0XG4gICAgbmV4dEVsZW1lbnQuaWQgPSBpdGVtLmlkXG4gICAgcmV0dXJuIG5leHRFbGVtZW50XG4gIH0pXG5cbiAgcmV0dXJuIG5leHRNb2RlbFxufVxuIl19
